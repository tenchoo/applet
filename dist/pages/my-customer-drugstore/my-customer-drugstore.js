"use strict";var _api=require("../../config/api"),common=require("../../common/js/common"),wxAPI=require("../../common/js/wxAPI"),app=getApp();Page({data:{placeHolder:"请输入药店名称",screenItem_1:"药店等级",screenItem_2:"是否连锁",screenItem_3:"是否医保",currentPage:"1",pageCount:"",clientPage:[],dataCount:"",floatBtnTapData:!1,defaultBool:!0},onShow:function(){common.searchGroup.apply(this,[]),this.getClientPage(this,"1"),this.getStarClientPage(this)},onHide:function(){this.setData({floatBtnTapData:!1})},getStarClientPage:function(t){wxAPI.postRequest(_api.api.star_pharmacy_list,{account_id:wx.getStorageSync("account_id")}).then(function(a){0===a.data.status?t.setData({starClientList:a.data.data.starList,defaultBool:!1}):t.setData({starClientList:[]})})},getClientPage:function(t,a){var e=this,n={account_id:wx.getStorageSync("account_id"),page:a};wxAPI.postRequest(_api.api.pharmacy_page,n).then(function(n){if(console.log(n),0===n.data.status){var o=n.data.data;"1"===a?t.setData({dataCount:o.dataCount,currentPage:o.currentPage,pageCount:o.pageCount,clientPage:o.clientPage,defaultBool:!1}):t.setData({currentPage:o.currentPage,defaultBool:!1,clientPage:e.data.clientPage.concat(o.clientPage)})}else t.setData({defaultBool:!0,dataCount:"",currentPage:"",pageCount:"",clientPage:[]})})},onReachBottom:function(){this.data.currentPage<this.data.pageCount&&this.getClientPage(this,parseInt(this.data.currentPage)+1+"")},floatBtnTap:function(){var t=!this.data.floatBtnTapData;this.setData({floatBtnTapData:t})},delSelf:function(t){var a=t.currentTarget.id;wxAPI.showModal("","是否删除该客户？","删除").then(function(t){t.confirm&&wxAPI.postRequest(_api.api.client_delete,{client_id:a}).then(function(t){if(0===t.data.status){var a={title:"操作成功",icon:"success"};wxAPI.wxPromiseObj(wx.showToast,a).then(function(t){wx.navigateTo({url:"my-customer-drugstore"})})}})})}});